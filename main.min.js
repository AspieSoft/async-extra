const t=t=>new Promise(e=>setTimeout(e,t));async function e(e,n=1e4,i=10){if(i<1&&(i=1),"function"==typeof e){e()&&e();let o=0;for(;!(e()||(await t(i),o++,!1!==n&&o>=n/i)););return e()}return console.error("TypeError: waitForValue expects a function with a return value"),!1}function n(t,e){if("string"==typeof t&&(t=[t]),t&&"object"==typeof t){let n=Object.keys(t);for(let i=0;i<n.length;i++)e(t[n[i]],n[i],t)}else if(t&&Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n],n,t)}module.exports={function:function(){let t={timeout:1e4,checkInterval:10},i=0,o=0,r=[];function c(e,n){"object"==typeof e?Object.assign(t,e):"string"==typeof e&&(t[e]=n)}function u(){"object"==typeof arguments[0]&&"function"!=typeof arguments[0]&&Object.assign(t,arguments[0]);let e=i;i+=arguments.length,n(arguments,async(t,n)=>{n=Number(n)+Number(e),"function"==typeof t&&(r[n]=await t()),o++})}function f(t,e){i++,(async()=>{r[t]=await e(),o++})()}function s(n){return e(()=>o>=i,t.timeout,t.checkInterval).then(()=>{const t=o>=i;return"function"==typeof n&&r.forEach((e,i)=>{void 0!==e&&n(e,i,r,t)}),{results:r,finished:t,unfinished:i-o}})}async function a(){return await e(()=>o>=i,t.timeout,t.checkInterval),!(o<i)&&i-o}async function l(){return await e(()=>o>=i,t.timeout,t.checkInterval),{results:r,finished:o>=i,unfinished:i-o}}function y(){return{results:r,finished:o>=i,unfinished:i-o}}function h(){return e(()=>o>=1,t.timeout,t.checkInterval).then(()=>{const t=o>=i;let e=void 0,c=!1;return n(r,(t,n)=>{void 0===e&&void 0!==t&&(e=t,c=n)}),{result:e,index:c,results:r,finished:t,unfinished:i-o}})}function d(n=0){return e(()=>void 0!==r[n],t.timeout,t.checkInterval).then(()=>({result:r[n],index:n}))}return arguments&&arguments.length>0&&("object"==typeof arguments[0]&&"function"!=typeof arguments[0]&&Object.assign(t,arguments[0]),t.resultObject&&(r={}),i=arguments.length,n(arguments,async(t,e)=>{"function"==typeof t&&(r[e]=await t()),o++})),{options:c,add:u,addIndex:f,onFinish:s,wait:a,result:l,resultSync:y,firstResult:h,resultIndex:d}},forEach:function(t,i,o){if(!t||"function"!=typeof i)return;"object"==typeof t||Array.isArray(t)||(t=[t]);let r={timeout:1e4,checkInterval:10};"object"==typeof o&&Object.assign(r,o);let c=t.length;return"object"==typeof t&&(c=Object.keys(t).length),n(t,async(e,n)=>{await i(e,n,t),c--}),e(()=>c<=0,r.timeout,r.checkInterval).then(()=>({finished:c<=0,unfinished:c}))},map:function(t,i,o){if(!t||"function"!=typeof i)return;"object"==typeof t||Array.isArray(t)||(t=[t]);let r={timeout:1e4,checkInterval:10};"object"==typeof o&&Object.assign(r,o);let c=t.length;"object"==typeof t&&(c=Object.keys(t).length);let u=function(t){return Array.isArray(t)?[]:"object"==typeof t?{}:void 0}(t);return n(t,async(e,n)=>{u[n]=await i(e,n,t),c--}),e(()=>c<=0,r.timeout,r.checkInterval).then(()=>({result:u,finished:c<=0,unfinished:c}))},sleep:t,waitForValue:e};